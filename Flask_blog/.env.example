# ===================================
# Flask Blog 生产环境配置模板
# ===================================
# 使用方式：复制为 .env 并修改敏感值
# Copy-Item .env.example .env

# ===================================
# 应用基础配置
# ===================================
FLASK_CONFIG=production
FLASK_APP=app:create_app
APP_ENV=prod
APP_VERSION=1.0.0
LOG_LEVEL=INFO
DEBUG=false
TZ=UTC

# ===================================
# 安全密钥配置 (必须修改！)
# ===================================
# 生成强随机密钥：python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET_KEY=CHANGE-ME-TO-STRONG-RANDOM-KEY-IN-PRODUCTION
JWT_ACCESS_MINUTES=30
JWT_REFRESH_DAYS=14

# ===================================
# 数据库配置
# ===================================
DATABASE_URL=mysql+pymysql://blog:CHANGE-ME-STRONG-DB-PASSWORD@db:3306/blog?charset=utf8mb4
MYSQL_ROOT_PASSWORD=CHANGE-ME-STRONG-ROOT-PASSWORD
MYSQL_DATABASE=blog
MYSQL_USER=blog
MYSQL_PASSWORD=CHANGE-ME-STRONG-DB-PASSWORD

# ===================================
# Redis 配置
# ===================================
REDIS_URL=redis://:CHANGE-ME-REDIS-PASSWORD@redis:6379/0
REDIS_PASSWORD=CHANGE-ME-REDIS-PASSWORD

# ===================================
# Celery 异步任务配置
# ===================================
CELERY_BROKER_URL=redis://:CHANGE-ME-REDIS-PASSWORD@redis:6379/0
CELERY_RESULT_BACKEND=redis://:CHANGE-ME-REDIS-PASSWORD@redis:6379/0

# ===================================
# 搜索引擎配置
# ===================================
MEILISEARCH_URL=http://meili:7700
MEILISEARCH_MASTER_KEY=CHANGE-ME-MEILI-MASTER-KEY
MEILI_KEY=CHANGE-ME-MEILI-MASTER-KEY
# 设置为 1 可跳过 ranking rules 更新 (调试场景)
MEILI_SKIP_RANKING_RULES=0

# ===================================
# 跨域和API配置
# ===================================
CORS_ORIGINS=*
# 生产环境建议设置具体域名：
# CORS_ORIGINS=https://yourdomain.com,https://admin.yourdomain.com

# ===================================
# 文件上传配置
# ===================================
UPLOAD_DIR=/app/backend/uploads_store
ALLOWED_IMAGE_TYPES=image/jpeg,image/png,image/webp,image/gif
MAX_IMAGE_SIZE=10485760
# 10MB = 10 * 1024 * 1024 bytes

# 支持的文档类型
ALLOWED_DOCUMENT_TYPES=application/pdf,text/plain,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document
MAX_DOCUMENT_SIZE=52428800
# 50MB = 50 * 1024 * 1024 bytes

# ===================================
# 数据库迁移和索引配置
# ===================================
AUTO_MIGRATE=1
REINDEX_ON_START=false

# ===================================
# 调度器和任务配置
# ===================================
ENABLE_SCHEDULER=true
SCHEDULE_CHECK_INTERVAL=60

# ===================================
# 限流配置
# ===================================
RATE_LIMIT_DEFAULT_MINUTE=200
RATE_LIMIT_DEFAULT_DAY=2000
RATE_LIMIT_STORAGE_URL=redis://:CHANGE-ME-REDIS-PASSWORD@redis:6379/1

# ===================================
# 邮件配置 (可选)
# ===================================
# MAIL_SERVER=smtp.gmail.com
# MAIL_PORT=587
# MAIL_USE_TLS=true
# MAIL_USERNAME=your-email@gmail.com
# MAIL_PASSWORD=your-app-password
# MAIL_DEFAULT_SENDER=your-email@gmail.com

# ===================================
# 云存储配置 (可选)
# ===================================
# AWS S3
# AWS_ACCESS_KEY_ID=your-aws-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret
# AWS_S3_BUCKET=your-bucket-name
# AWS_S3_REGION=us-east-1

# 阿里云 OSS
# ALIYUN_OSS_ACCESS_KEY_ID=your-oss-key
# ALIYUN_OSS_ACCESS_KEY_SECRET=your-oss-secret
# ALIYUN_OSS_BUCKET=your-bucket-name
# ALIYUN_OSS_ENDPOINT=oss-cn-hangzhou.aliyuncs.com

# ===================================
# 监控和告警配置
# ===================================
PROMETHEUS_ENABLED=true
METRICS_PORT=9090

# ===================================
# 备份配置
# ===================================
BACKUP_ENABLED=true
BACKUP_INTERVAL=daily
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=/app/backups

# ===================================
# 日志配置
# ===================================
LOG_FORMAT=json
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=5

# ===================================
# 性能配置
# ===================================
GUNICORN_WORKERS=4
GUNICORN_THREADS=4
GUNICORN_WORKER_CLASS=gthread
GUNICORN_MAX_REQUESTS=1000
GUNICORN_MAX_REQUESTS_JITTER=100

# ===================================
# 开发和调试配置
# ===================================
TESTING=false
WTF_CSRF_ENABLED=true

# ===================================
# SSL/HTTPS 配置 (Nginx 代理模式)
# ===================================
FORCE_HTTPS=true
SECURE_SSL_REDIRECT=true
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax
